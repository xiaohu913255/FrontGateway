{"remainingRequest":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\node_modules\\babel-loader\\lib\\index.js!E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\src\\store\\modules\\user.js","dependencies":[{"path":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\src\\store\\modules\\user.js","mtime":1725789930881},{"path":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\babel.config.js","mtime":1725789930622},{"path":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\Language\\Go\\Project\\Test\\test\\go_gateway_view\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"E:/Language/Go/Project/Test/test/go_gateway_view/node_modules/@babel/runtime/helpers/interopRequireWildcard.js\");\nvar _interopRequireDefault = require(\"E:/Language/Go/Project/Test/test/go_gateway_view/node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _regeneratorRuntime2 = _interopRequireDefault(require(\"E:/Language/Go/Project/Test/test/go_gateway_view/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\"));\nrequire(\"regenerator-runtime/runtime\");\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"E:/Language/Go/Project/Test/test/go_gateway_view/node_modules/@babel/runtime/helpers/asyncToGenerator.js\"));\nrequire(\"core-js/modules/es6.function.name\");\nvar _user = require(\"@/api/user\");\nvar _auth = require(\"@/utils/auth\");\nvar _router = _interopRequireWildcard(require(\"@/router\"));\nvar state = {\n  token: (0, _auth.getToken)(),\n  name: '',\n  avatar: '',\n  introduction: '',\n  roles: []\n};\nvar mutations = {\n  SET_TOKEN: function SET_TOKEN(state, token) {\n    state.token = token;\n  },\n  SET_INTRODUCTION: function SET_INTRODUCTION(state, introduction) {\n    state.introduction = introduction;\n  },\n  SET_NAME: function SET_NAME(state, name) {\n    state.name = name;\n  },\n  SET_AVATAR: function SET_AVATAR(state, avatar) {\n    state.avatar = avatar;\n  },\n  SET_ROLES: function SET_ROLES(state, roles) {\n    state.roles = roles;\n  }\n};\nvar actions = {\n  // user login\n  login: function login(_ref, userInfo) {\n    var commit = _ref.commit;\n    var username = userInfo.username,\n      password = userInfo.password;\n    return new Promise(function (resolve, reject) {\n      (0, _user.login)({\n        username: username.trim(),\n        password: password\n      }).then(function (response) {\n        var data = response.data;\n        commit('SET_TOKEN', data.token);\n        (0, _auth.setToken)(data.token);\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // get user info\n  getInfo: function getInfo(_ref2) {\n    var commit = _ref2.commit,\n      state = _ref2.state;\n    return new Promise(function (resolve, reject) {\n      (0, _user.getInfo)(state.token).then(function (response) {\n        var data = response.data;\n        if (!data) {\n          reject('Verification failed, please Login again.');\n        }\n        var roles = data.roles,\n          name = data.name,\n          avatar = data.avatar,\n          introduction = data.introduction;\n\n        // roles must be a non-empty array\n        if (!roles || roles.length <= 0) {\n          reject('getInfo: roles must be a non-null array!');\n        }\n        commit('SET_ROLES', roles);\n        commit('SET_NAME', name);\n        commit('SET_AVATAR', avatar);\n        commit('SET_INTRODUCTION', introduction);\n        resolve(data);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // user logout\n  logout: function logout(_ref3) {\n    var commit = _ref3.commit,\n      state = _ref3.state,\n      dispatch = _ref3.dispatch;\n    return new Promise(function (resolve, reject) {\n      (0, _user.logout)(state.token).then(function () {\n        commit('SET_TOKEN', '');\n        commit('SET_ROLES', []);\n        (0, _auth.removeToken)();\n        (0, _router.resetRouter)();\n\n        // reset visited views and cached views\n        // to fixed https://github.com/PanJiaChen/vue-element-admin/issues/2485\n        dispatch('tagsView/delAllViews', null, {\n          root: true\n        });\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // remove token\n  resetToken: function resetToken(_ref4) {\n    var commit = _ref4.commit;\n    return new Promise(function (resolve) {\n      commit('SET_TOKEN', '');\n      commit('SET_ROLES', []);\n      (0, _auth.removeToken)();\n      resolve();\n    });\n  },\n  // dynamically modify permissions\n  changeRoles: function changeRoles(_ref5, role) {\n    var commit = _ref5.commit,\n      dispatch = _ref5.dispatch;\n    return new Promise(/*#__PURE__*/function () {\n      var _ref6 = (0, _asyncToGenerator2.default)(/*#__PURE__*/(0, _regeneratorRuntime2.default)().mark(function _callee(resolve) {\n        var token, _yield$dispatch, roles, accessRoutes;\n        return (0, _regeneratorRuntime2.default)().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              token = role + '-token';\n              commit('SET_TOKEN', token);\n              (0, _auth.setToken)(token);\n              _context.next = 5;\n              return dispatch('getInfo');\n            case 5:\n              _yield$dispatch = _context.sent;\n              roles = _yield$dispatch.roles;\n              (0, _router.resetRouter)();\n\n              // generate accessible routes map based on roles\n              _context.next = 10;\n              return dispatch('permission/generateRoutes', roles, {\n                root: true\n              });\n            case 10:\n              accessRoutes = _context.sent;\n              // dynamically add accessible routes\n              _router.default.addRoutes(accessRoutes);\n\n              // reset visited views and cached views\n              dispatch('tagsView/delAllViews', null, {\n                root: true\n              });\n              resolve();\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n  }\n};\nvar _default = exports.default = {\n  namespaced: true,\n  state: state,\n  mutations: mutations,\n  actions: actions\n};",{"version":3,"names":["_user","require","_auth","_router","_interopRequireWildcard","state","token","getToken","name","avatar","introduction","roles","mutations","SET_TOKEN","SET_INTRODUCTION","SET_NAME","SET_AVATAR","SET_ROLES","actions","login","_ref","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","setToken","catch","error","getInfo","_ref2","length","logout","_ref3","dispatch","removeToken","resetRouter","root","resetToken","_ref4","changeRoles","_ref5","role","_ref6","_asyncToGenerator2","default","_regeneratorRuntime2","mark","_callee","_yield$dispatch","accessRoutes","wrap","_callee$","_context","prev","next","sent","router","addRoutes","stop","_x","apply","arguments","_default","exports","namespaced"],"sources":["E:/Language/Go/Project/Test/test/go_gateway_view/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\nimport router, { resetRouter } from '@/router'\r\n\r\nconst state = {\r\n  token: getToken(),\r\n  name: '',\r\n  avatar: '',\r\n  introduction: '',\r\n  roles: []\r\n}\r\n\r\nconst mutations = {\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_INTRODUCTION: (state, introduction) => {\r\n    state.introduction = introduction\r\n  },\r\n  SET_NAME: (state, name) => {\r\n    state.name = name\r\n  },\r\n  SET_AVATAR: (state, avatar) => {\r\n    state.avatar = avatar\r\n  },\r\n  SET_ROLES: (state, roles) => {\r\n    state.roles = roles\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  // user login\r\n  login({ commit }, userInfo) {\r\n    const { username, password } = userInfo\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password }).then(response => {\r\n        const { data } = response\r\n        commit('SET_TOKEN', data.token)\r\n        setToken(data.token)\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // get user info\r\n  getInfo({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      getInfo(state.token).then(response => {\r\n        const { data } = response\r\n\r\n        if (!data) {\r\n          reject('Verification failed, please Login again.')\r\n        }\r\n\r\n        const { roles, name, avatar, introduction } = data\r\n\r\n        // roles must be a non-empty array\r\n        if (!roles || roles.length <= 0) {\r\n          reject('getInfo: roles must be a non-null array!')\r\n        }\r\n\r\n        commit('SET_ROLES', roles)\r\n        commit('SET_NAME', name)\r\n        commit('SET_AVATAR', avatar)\r\n        commit('SET_INTRODUCTION', introduction)\r\n        resolve(data)\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit, state, dispatch }) {\r\n    return new Promise((resolve, reject) => {\r\n      logout(state.token).then(() => {\r\n        commit('SET_TOKEN', '')\r\n        commit('SET_ROLES', [])\r\n        removeToken()\r\n        resetRouter()\r\n\r\n        // reset visited views and cached views\r\n        // to fixed https://github.com/PanJiaChen/vue-element-admin/issues/2485\r\n        dispatch('tagsView/delAllViews', null, { root: true })\r\n\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      commit('SET_TOKEN', '')\r\n      commit('SET_ROLES', [])\r\n      removeToken()\r\n      resolve()\r\n    })\r\n  },\r\n\r\n  // dynamically modify permissions\r\n  changeRoles({ commit, dispatch }, role) {\r\n    return new Promise(async resolve => {\r\n      const token = role + '-token'\r\n\r\n      commit('SET_TOKEN', token)\r\n      setToken(token)\r\n\r\n      const { roles } = await dispatch('getInfo')\r\n\r\n      resetRouter()\r\n\r\n      // generate accessible routes map based on roles\r\n      const accessRoutes = await dispatch('permission/generateRoutes', roles, { root: true })\r\n\r\n      // dynamically add accessible routes\r\n      router.addRoutes(accessRoutes)\r\n\r\n      // reset visited views and cached views\r\n      dispatch('tagsView/delAllViews', null, { root: true })\r\n\r\n      resolve()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"],"mappings":";;;;;;;;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAC,uBAAA,CAAAH,OAAA;AAEA,IAAMI,KAAK,GAAG;EACZC,KAAK,EAAE,IAAAC,cAAQ,EAAC,CAAC;EACjBC,IAAI,EAAE,EAAE;EACRC,MAAM,EAAE,EAAE;EACVC,YAAY,EAAE,EAAE;EAChBC,KAAK,EAAE;AACT,CAAC;AAED,IAAMC,SAAS,GAAG;EAChBC,SAAS,EAAE,SAAXA,SAASA,CAAGR,KAAK,EAAEC,KAAK,EAAK;IAC3BD,KAAK,CAACC,KAAK,GAAGA,KAAK;EACrB,CAAC;EACDQ,gBAAgB,EAAE,SAAlBA,gBAAgBA,CAAGT,KAAK,EAAEK,YAAY,EAAK;IACzCL,KAAK,CAACK,YAAY,GAAGA,YAAY;EACnC,CAAC;EACDK,QAAQ,EAAE,SAAVA,QAAQA,CAAGV,KAAK,EAAEG,IAAI,EAAK;IACzBH,KAAK,CAACG,IAAI,GAAGA,IAAI;EACnB,CAAC;EACDQ,UAAU,EAAE,SAAZA,UAAUA,CAAGX,KAAK,EAAEI,MAAM,EAAK;IAC7BJ,KAAK,CAACI,MAAM,GAAGA,MAAM;EACvB,CAAC;EACDQ,SAAS,EAAE,SAAXA,SAASA,CAAGZ,KAAK,EAAEM,KAAK,EAAK;IAC3BN,KAAK,CAACM,KAAK,GAAGA,KAAK;EACrB;AACF,CAAC;AAED,IAAMO,OAAO,GAAG;EACd;EACAC,KAAK,WAALA,KAAKA,CAAAC,IAAA,EAAaC,QAAQ,EAAE;IAAA,IAApBC,MAAM,GAAAF,IAAA,CAANE,MAAM;IACZ,IAAQC,QAAQ,GAAeF,QAAQ,CAA/BE,QAAQ;MAAEC,QAAQ,GAAKH,QAAQ,CAArBG,QAAQ;IAC1B,OAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;MACtC,IAAAR,WAAK,EAAC;QAAEI,QAAQ,EAAEA,QAAQ,CAACK,IAAI,CAAC,CAAC;QAAEJ,QAAQ,EAAEA;MAAS,CAAC,CAAC,CAACK,IAAI,CAAC,UAAAC,QAAQ,EAAI;QACxE,IAAQC,IAAI,GAAKD,QAAQ,CAAjBC,IAAI;QACZT,MAAM,CAAC,WAAW,EAAES,IAAI,CAACzB,KAAK,CAAC;QAC/B,IAAA0B,cAAQ,EAACD,IAAI,CAACzB,KAAK,CAAC;QACpBoB,OAAO,CAAC,CAAC;MACX,CAAC,CAAC,CAACO,KAAK,CAAC,UAAAC,KAAK,EAAI;QAChBP,MAAM,CAACO,KAAK,CAAC;MACf,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;EAED;EACAC,OAAO,WAAPA,OAAOA,CAAAC,KAAA,EAAoB;IAAA,IAAjBd,MAAM,GAAAc,KAAA,CAANd,MAAM;MAAEjB,KAAK,GAAA+B,KAAA,CAAL/B,KAAK;IACrB,OAAO,IAAIoB,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;MACtC,IAAAQ,aAAO,EAAC9B,KAAK,CAACC,KAAK,CAAC,CAACuB,IAAI,CAAC,UAAAC,QAAQ,EAAI;QACpC,IAAQC,IAAI,GAAKD,QAAQ,CAAjBC,IAAI;QAEZ,IAAI,CAACA,IAAI,EAAE;UACTJ,MAAM,CAAC,0CAA0C,CAAC;QACpD;QAEA,IAAQhB,KAAK,GAAiCoB,IAAI,CAA1CpB,KAAK;UAAEH,IAAI,GAA2BuB,IAAI,CAAnCvB,IAAI;UAAEC,MAAM,GAAmBsB,IAAI,CAA7BtB,MAAM;UAAEC,YAAY,GAAKqB,IAAI,CAArBrB,YAAY;;QAEzC;QACA,IAAI,CAACC,KAAK,IAAIA,KAAK,CAAC0B,MAAM,IAAI,CAAC,EAAE;UAC/BV,MAAM,CAAC,0CAA0C,CAAC;QACpD;QAEAL,MAAM,CAAC,WAAW,EAAEX,KAAK,CAAC;QAC1BW,MAAM,CAAC,UAAU,EAAEd,IAAI,CAAC;QACxBc,MAAM,CAAC,YAAY,EAAEb,MAAM,CAAC;QAC5Ba,MAAM,CAAC,kBAAkB,EAAEZ,YAAY,CAAC;QACxCgB,OAAO,CAACK,IAAI,CAAC;MACf,CAAC,CAAC,CAACE,KAAK,CAAC,UAAAC,KAAK,EAAI;QAChBP,MAAM,CAACO,KAAK,CAAC;MACf,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;EAED;EACAI,MAAM,WAANA,MAAMA,CAAAC,KAAA,EAA8B;IAAA,IAA3BjB,MAAM,GAAAiB,KAAA,CAANjB,MAAM;MAAEjB,KAAK,GAAAkC,KAAA,CAALlC,KAAK;MAAEmC,QAAQ,GAAAD,KAAA,CAARC,QAAQ;IAC9B,OAAO,IAAIf,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;MACtC,IAAAW,YAAM,EAACjC,KAAK,CAACC,KAAK,CAAC,CAACuB,IAAI,CAAC,YAAM;QAC7BP,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;QACvBA,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;QACvB,IAAAmB,iBAAW,EAAC,CAAC;QACb,IAAAC,mBAAW,EAAC,CAAC;;QAEb;QACA;QACAF,QAAQ,CAAC,sBAAsB,EAAE,IAAI,EAAE;UAAEG,IAAI,EAAE;QAAK,CAAC,CAAC;QAEtDjB,OAAO,CAAC,CAAC;MACX,CAAC,CAAC,CAACO,KAAK,CAAC,UAAAC,KAAK,EAAI;QAChBP,MAAM,CAACO,KAAK,CAAC;MACf,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;EAED;EACAU,UAAU,WAAVA,UAAUA,CAAAC,KAAA,EAAa;IAAA,IAAVvB,MAAM,GAAAuB,KAAA,CAANvB,MAAM;IACjB,OAAO,IAAIG,OAAO,CAAC,UAAAC,OAAO,EAAI;MAC5BJ,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;MACvBA,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;MACvB,IAAAmB,iBAAW,EAAC,CAAC;MACbf,OAAO,CAAC,CAAC;IACX,CAAC,CAAC;EACJ,CAAC;EAED;EACAoB,WAAW,WAAXA,WAAWA,CAAAC,KAAA,EAAuBC,IAAI,EAAE;IAAA,IAA1B1B,MAAM,GAAAyB,KAAA,CAANzB,MAAM;MAAEkB,QAAQ,GAAAO,KAAA,CAARP,QAAQ;IAC5B,OAAO,IAAIf,OAAO;MAAA,IAAAwB,KAAA,OAAAC,kBAAA,CAAAC,OAAA,mBAAAC,oBAAA,CAAAD,OAAA,IAAAE,IAAA,CAAC,SAAAC,QAAM5B,OAAO;QAAA,IAAApB,KAAA,EAAAiD,eAAA,EAAA5C,KAAA,EAAA6C,YAAA;QAAA,WAAAJ,oBAAA,CAAAD,OAAA,IAAAM,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACxBvD,KAAK,GAAG0C,IAAI,GAAG,QAAQ;cAE7B1B,MAAM,CAAC,WAAW,EAAEhB,KAAK,CAAC;cAC1B,IAAA0B,cAAQ,EAAC1B,KAAK,CAAC;cAAAqD,QAAA,CAAAE,IAAA;cAAA,OAESrB,QAAQ,CAAC,SAAS,CAAC;YAAA;cAAAe,eAAA,GAAAI,QAAA,CAAAG,IAAA;cAAnCnD,KAAK,GAAA4C,eAAA,CAAL5C,KAAK;cAEb,IAAA+B,mBAAW,EAAC,CAAC;;cAEb;cAAAiB,QAAA,CAAAE,IAAA;cAAA,OAC2BrB,QAAQ,CAAC,2BAA2B,EAAE7B,KAAK,EAAE;gBAAEgC,IAAI,EAAE;cAAK,CAAC,CAAC;YAAA;cAAjFa,YAAY,GAAAG,QAAA,CAAAG,IAAA;cAElB;cACAC,eAAM,CAACC,SAAS,CAACR,YAAY,CAAC;;cAE9B;cACAhB,QAAQ,CAAC,sBAAsB,EAAE,IAAI,EAAE;gBAAEG,IAAI,EAAE;cAAK,CAAC,CAAC;cAEtDjB,OAAO,CAAC,CAAC;YAAA;YAAA;cAAA,OAAAiC,QAAA,CAAAM,IAAA;UAAA;QAAA,GAAAX,OAAA;MAAA,CACV;MAAA,iBAAAY,EAAA;QAAA,OAAAjB,KAAA,CAAAkB,KAAA,OAAAC,SAAA;MAAA;IAAA,IAAC;EACJ;AACF,CAAC;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAnB,OAAA,GAEc;EACboB,UAAU,EAAE,IAAI;EAChBlE,KAAK,EAALA,KAAK;EACLO,SAAS,EAATA,SAAS;EACTM,OAAO,EAAPA;AACF,CAAC","ignoreList":[]}]}